%https://ieeexplore.ieee.org/document/745619
%http://sci-hub.tw/https://doi.org/10.1109/IEMBS.1998.745619

%Crop the image and take the ROI of 120*120 pixels(smaller out of two, the other one being 420*420)
%Extract input features

http://in.mathworks.com/help/deeplearning/gs/classify-patterns-with-a-neural-network.html;jsessionid=6964bb83128aa2c19ba9aa19ac61#f9-26645

[inputs,targets] = cancer_dataset;     %loading dataset

%Solve a Pattern Recognition Problem with a Neural Network
% Script generated by NPRTOOL
%
% This script assumes these variables are defined:
%
%   cancerInputs - input data.
%   cancerTargets - target data.

inputs = cancerInputs;
targets = cancerTargets;

% Create a Pattern Recognition Network
hiddenLayerSize = 10;
net = patternnet(hiddenLayerSize,mse);   %https://in.mathworks.com/help/deeplearning/ref/mse.html
net.layers{i}.transferFcn = 'tansig';


% Set up Division of Data for Training, Validation, Testing
net.divideParam.trainRatio = 70/100;
net.divideParam.valRatio = 15/100;
net.divideParam.testRatio = 15/100;


% Train the Network
[net,tr] = train(net,inputs,targets);

% Test the Network
outputs = net(inputs);
errors = gsubtract(targets,outputs);
performance = perform(net,targets,outputs)

% View the Network
view(net)

% Plots
% Uncomment these lines to enable various plots.
% figure, plotperform(tr)
% figure, plottrainstate(tr)
% figure, plotconfusion(targets,outputs)
% figure, ploterrhist(errors)
